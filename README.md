# WP Plugin Cleanup Script

–°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞–≥–∏–Ω–æ–º "All-in-One WP Security and Firewall" (AIOWPS) –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö —Å –ø–∞–Ω–µ–ª—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Hestia CP.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:
- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö WordPress —Å–∞–π—Ç–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–ª–∞–≥–∏–Ω–∞ AIOWPS
- –ú–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–ª–∞–≥–∏–Ω–∞ —Å–æ –≤—Å–µ—Ö —Å–∞–π—Ç–æ–≤
- –û—á–∏—Å—Ç–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ WP-CLI

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Linux —Å –ø–∞–Ω–µ–ª—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Hestia CP
- **–ü—Ä–∞–≤–∞**: –ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ root
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: 
  - `curl` (–¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ WP-CLI)
  - `mysql` (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö)
  - –ö–æ–º–∞–Ω–¥—ã Hestia CP (`v-list-users`, `v-list-web-domains`)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:**
```bash
wget https://raw.githubusercontent.com/Traffic-Connect/wp_plugin_cleanup/main/wp.sh
```

2. **–°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:**
```bash
chmod +x wp.sh
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç root:**
```bash
sudo ./wp.sh
```

## üìñ –§—É–Ω–∫—Ü–∏–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å WP-CLI
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç WordPress Command Line Interface –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞–º–∏.

### 2. –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–∞–π—Ç—ã
–ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –¥–æ–º–µ–Ω–∞–º –≤ Hestia CP, –ø—Ä–æ–≤–µ—Ä—è—è –Ω–∞–ª–∏—á–∏–µ –ø–ª–∞–≥–∏–Ω–∞ AIOWPS.

### 3. –£–¥–∞–ª–∏—Ç—å –ø–ª–∞–≥–∏–Ω
- –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–ª–∞–≥–∏–Ω —á–µ—Ä–µ–∑ WP-CLI
- –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã –ø–ª–∞–≥–∏–Ω–∞
- –†–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ —Å–∞–π—Ç–∞–º–∏

### 4. Dry-run
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–ª–∞–≥–∏–Ω, –±–µ–∑ –µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏).

### 5. –£–¥–∞–ª–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ MySQL
–£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `aiowps_` –∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö WordPress —Å–∞–π—Ç–æ–≤.

### 6. –í—ã—Ö–æ–¥
–ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–∞.

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª:
```
/var/log/wp_plugin_cleanup.log
```

–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤:
```
[2024-01-15 10:30:45] üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–π—Ç–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–ª–∞–≥–∏–Ω–∞ 'all-in-one-wp-security-and-firewall'
[2024-01-15 10:30:46] üìç [example.com] –ü–ª–∞–≥–∏–Ω –Ω–∞–π–¥–µ–Ω
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –ø–ª–∞–≥–∏–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–∞–π—Ç–æ–≤
2. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –æ—Ç –∏–º–µ–Ω–∏ root
3. **Hestia CP**: –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø–∞–Ω–µ–ª—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Hestia CP
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –£–¥–∞–ª–µ–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –∑–∞—â–∏—Ç—É —Å–∞–π—Ç–æ–≤

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∫—Ä–∏–ø—Ç–∞

```
wp.sh
‚îú‚îÄ‚îÄ –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ check_root() - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ root
‚îÇ   ‚îî‚îÄ‚îÄ install_wp_cli() - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ WP-CLI
‚îú‚îÄ‚îÄ –§—É–Ω–∫—Ü–∏–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ scan_sites() - –ø–æ–∏—Å–∫ –ø–ª–∞–≥–∏–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ dry_run() - —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
‚îú‚îÄ‚îÄ –§—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ remove_plugin() - —É–¥–∞–ª–µ–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ drop_aiowps_tables() - –æ—á–∏—Å—Ç–∫–∞ –ë–î
‚îî‚îÄ‚îÄ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    ‚îî‚îÄ‚îÄ show_menu() - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ "–°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –æ—Ç root!"
```bash
sudo ./wp.sh
```

### WP-CLI –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ `/usr/local/bin/`

### –û—à–∏–±–∫–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MySQL —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT.

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:
https://github.com/Traffic-Connect/wp_plugin_cleanup
